pipeline for the code to run

1: get your dataset done in dataset/...
(gsm)
python template.py --data_path dataset/multiple_choice/gsm_test.json --save_path dataset/multiple_choice/processed_gsm_test.json --case choice --question_number 3

python template.py --data_path dataset/blank/gsm_test.json --save_path dataset/blank/processed_gsm_test.json --case blank --question_number 3

python template.py --data_path dataset/multiple_choice/gsm_train.json --save_path dataset/multiple_choice/processed_gsm_train.json --case choice --question_number 3

python template.py --data_path dataset/blank/gsm_train.json --save_path dataset/blank/processed_gsm_train.json --case blank --question_number 3

(pararel)
python template.py --data_path dataset/multiple_choice/pararel_test.json --save_path dataset/multiple_choice/processed_pararel_test.json --case choice --question_number 3

python template.py --data_path dataset/blank/pararel_test.json --save_path dataset/blank/processed_pararel_test.json --case blank --question_number 3

python template.py --data_path dataset/multiple_choice/pararel_train.json --save_path dataset/multiple_choice/processed_pararel_train.json --case choice --question_number 3

python template.py --data_path dataset/blank/pararel_train.json --save_path dataset/blank/processed_pararel_train.json --case blank --question_number 3

(MMLU)
python template.py --data_path dataset/multiple_choice/mmlu_test.json --save_path dataset/multiple_choice/processed_mmlu_test.json --case choice --question_number 3

python template.py --data_path dataset/blank/mmlu_test.json --save_path dataset/blank/processed_mmlu_test.json --case blank --question_number 3

python template.py --data_path dataset/multiple_choice/mmlu_train.json --save_path dataset/multiple_choice/processed_mmlu_train.json --case choice --question_number 3

python template.py --data_path dataset/blank/mmlu_train.json --save_path dataset/blank/processed_mmlu_train.json --case blank --question_number 3

----------------------------------------------------------------------------------------------------------------------------------------------------------------
2: generate the output
(gsm)
python generate_output.py --data_path dataset/multiple_choice/processed_gsm_test.json --save_path result/multiple_choice/gsm.json --generate_vllm --gpu 3

python generate_output.py --data_path dataset/blank/processed_gsm_test.json --save_path result/blank/gsm.json --case blank --generate_vllm --gpu 3

python generate_output.py --data_path dataset/multiple_choice/processed_gsm_train.json --save_path result/multiple_choice/gsm.json --generate_vllm --gpu 0

python generate_output.py --data_path dataset/blank/processed_gsm_train.json --save_path result/blank/gsm.json --case blank --generate_vllm --gpu 3

(pararel)
python generate_output.py --data_path dataset/multiple_choice/processed_pararel_test.json --save_path result/multiple_choice/pararel.json --generate_vllm --gpu 3

python generate_output.py --data_path dataset/blank/processed_pararel_test.json --save_path result/blank/pararel.json --case blank --generate_vllm --gpu 3

python generate_output.py --data_path dataset/multiple_choice/processed_pararel_train.json --save_path result/multiple_choice/pararel.json --generate_vllm --gpu 3

python generate_output.py --data_path dataset/blank/processed_pararel_train.json --save_path result/blank/pararel.json --case blank --generate_vllm --gpu 3

(MMLU)
python generate_output.py --data_path dataset/multiple_choice/processed_mmlu_test.json --save_path result/multiple_choice/mmlu.json  --generate_vllm --gpu 0

python generate_output.py --data_path dataset/blank/processed_mmlu_test.json --save_path result/blank/mmlu.json --case blank --generate_vllm --gpu 3

python generate_output.py --data_path dataset/multiple_choice/processed_mmlu_train.json --save_path result/multiple_choice/mmlu.json  --generate_vllm --gpu 3

python generate_output.py --data_path dataset/blank/processed_mmlu_train.json --save_path result/blank/mmlu.json --case blank --generate_vllm --gpu 3

----------------------------------------------------------------------------------------------------------------------------------------------------------------
3: compare the output and ground truth label
(multiple_choice)
python compare.py --data_path result/multiple_choice/gsm.json --case choice --question_number 3

python compare.py --data_path result/multiple_choice/pararel.json --case choice --question_number 3

python compare.py --data_path result/multiple_choice/mmlu.json --case choice --question_number 3

(blank)
python compare.py --data_path result/blank/gsm.json --case blank --question_number 3

python compare.py --data_path result/blank/pararel.json --case blank --question_number 3

python compare.py --data_path result/blank/mmlu.json --case blank --question_number 3

------------------------------------------------------------------------------------------------------------
4: divide the dataset into certain and uncertain
(gsm)
python divide_dataset.py --data_path dataset/multiple_choice/processed_gsm_train.json --result result/multiple_choice/gsm.json --save_path dataset/multiple_choice/gsm_split/gsm --case choice

python divide_dataset.py --data_path dataset/blank/processed_gsm_train.json --result result/blank/gsm.json --save_path dataset/blank/gsm_split/gsm --case blank

(pararel)
python divide_dataset.py --data_path dataset/multiple_choice/processed_pararel_train.json --result result/multiple_choice/pararel.json --save_path dataset/multiple_choice/pararel_split/pararel --case choice

python divide_dataset.py --data_path dataset/blank/processed_pararel_train.json --result result/blank/pararel.json --save_path dataset/blank/pararel_split/pararel --case blank

(MMLU)
python divide_dataset.py --data_path dataset/multiple_choice/processed_mmlu_train.json --result result/multiple_choice/mmlu.json --save_path dataset/multiple_choice/mmlu_split/mmlu --case choice

python divide_dataset.py --data_path dataset/blank/processed_mmlu_train.json --result result/blank/mmlu.json --save_path dataset/blank/mmlu_split/mmlu --case blank

----------------------------------------------------------------------------------------------------------------------------------------------------------------
5: fine-tune the model and save and model
(gsm)
python fine_tune.py --data_path dataset/blank/gsm_split/gsm --save_path models/blank/llama3_gsm --case blank --gpu 1

python fine_tune.py --data_path dataset/multiple_choice/gsm_split/gsm --save_path models/multiple_choice/llama3_gsm --case choice --gpu 1

(pararel)
python fine_tune.py --data_path dataset/blank/pararel_split/pararel --save_path models/blank/llama3_pararel --case blank --gpu 1

python fine_tune.py --data_path dataset/multiple_choice/pararel_split/pararel --save_path models/multiple_choice/llama3_pararel --case choice --gpu 1

(MMLU)
python fine_tune.py --data_path dataset/multiple_choice/mmlu_split/mmlu --save_path models/multiple_choice/llama3_mmlu --case choice --gpu 1

python fine_tune.py --data_path dataset/blank/mmlu_split/mmlu --save_path models/blank/llama3_mmlu --case blank --gpu 1

----------------------------------------------------------------------------------------------------------------------------------------------------------------
6: generate the result again
(gsm)
python generate_output.py --data_path dataset/multiple_choice/processed_gsm_test.json --save_path fine_tune_result/multiple_choice/gsm.json --lora_model --lora_path models/multiple_choice/llama3_gsm --case choice --question_number 3 --gpu 0

python generate_output.py --data_path dataset/blank/processed_gsm_test.json --save_path fine_tune_result/blank/gsm.json --lora_model --lora_path models/blank/llama3_gsm --case blank --question_number 3 --gpu 3

(pararel)
python generate_output.py --data_path dataset/multiple_choice/processed_pararel_test.json --save_path fine_tune_result/multiple_choice/pararel.json --lora_model --lora_path models/multiple_choice/llama3_pararel --case choice --question_number 3 --gpu 0

python generate_output.py --data_path dataset/blank/processed_pararel_test.json --save_path fine_tune_result/blank/pararel.json --lora_model --lora_path models/blank/llama3_pararel --case blank --question_number 3 --gpu 3

(MMLU)
python generate_output.py --data_path dataset/multiple_choice/processed_mmlu_test.json --save_path fine_tune_result/multiple_choice/mmlu.json --lora_model --lora_path models/multiple_choice/llama3_mmlu --case choice --question_number 3 --gpu 0

python generate_output.py --data_path dataset/blank/processed_mmlu_test.json --save_path fine_tune_result/blank/mmlu.json --lora_model --lora_path models/blank/llama3_mmlu --case blank --question_number 3 --gpu 3

----------------------------------------------------------------------------------------------------------------------------------------------------------------
7: compare the output with the ground truth label again
(multiple_choice)
python compare.py --data_path fine_tune_result/multiple_choice/gsm.json --case choice --question_number 3

python compare.py --data_path fine_tune_result/multiple_choice/pararel.json --question_number 3

python compare.py --data_path fine_tune_result/multiple_choice/mmlu.json --question_number 3

(blank):
python compare.py --data_path fine_tune_result/blank/gsm.json --case blank --question_number 3

python compare.py --data_path fine_tune_result/blank/pararel.json --case blank --question_number 3

python compare.py --data_path fine_tune_result/blank/mmlu.json --case blank --question_number 3

---------------------------------------------------------------------------------------------------------------------------------------------------------------
8: calculate the AP score
(blank)
python calculate_ap.py --data_path fine_tune_result/blank/gsm.json --lora_path models/blank/llama3_gsm --case blank 

python calculate_ap.py --data_path fine_tune_result/blank/pararel.json --lora_path models/blank/llama3_pararel --case blank 

(choice)
python calculate_ap.py --data_path fine_tune_result/multiple_choice/gsm.json --lora_path models/multiple_choice/llama3_gsm --case choice 

python calculate_ap.py --data_path fine_tune_result/multiple_choice/pararel.json --lora_path models/multiple_choice/llama3_pararel --case choice

python calculate_ap.py --data_path fine_tune_result/multiple_choice/mmlu.json --lora_path models/multiple_choice/llama3_mmlu --case choice





